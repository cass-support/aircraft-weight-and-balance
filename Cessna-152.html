<html>
    <head>
        <title>Cessna C152 Weight & Balance</title>
        <script src="https://cdn.plot.ly/plotly-1.58.4.min.js"></script>
        <script>
            var aircraftArmData = {
                'C152': {
                    'pilot': 39.0,
                    'passenger1': 39.0,
                    'area1': 64.0,
                    'area2': 84.0,
                    'fuel': 42.0
                },
            };
        </script>
    </head>
    <body>
        <div>
            <fieldset>
                <legend>Aircraft Data</legend>

                <table>
                    <tr>
                        <td><label for="call_sign">Call Sign</label></td>
                        <td>
                            <select name="call_sign">
                                <option>4X-CSN</option>
                                <option>4X-CGB</option>
                                <option>4X-CHG</option>
                            </select>
                        </td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><label>Latest Update</label></td>
                        <td>01/01/2021</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><label>Basic Empty Weight</label></td>
                        <td>1205</td>
                        <td>(lbs)</td>
                    </tr>
                    <tr>
                        <td><label>Center of Mass</label></td>
                        <td>31.25</td>
                        <td>(Inch)</td>
                    </tr>
                    <tr>
                        <td><label>Moment</label></td>
                        <td>37.656</td>
                        <td>(Inch-lbs/1000)</td>
                    </tr>
                </table>
            </fieldset>
        </div>
        <div>
            <fieldset>
                <legend>Load Data</legend>

                <table>
                    <tr>
                        <td></td>
                        <td>Weight</td>
                        <td>Units</td>
                        <td>Arm (Inch)</td>
                        <td>Moment (Inch-lbs/1000)</td>
                    </tr>
                    <tr>
                        <td><label for="txtPilotWeight">Pilot</label></td>
                        <td><input type="number" id="txtPilotWeight" name="pilot_weight" /></td>
                        <td>lbs</td>
                        <td>39.0</td>
                        <td>39.0</td>
                    </tr>
                    <tr>
                        <td><label for="txtPassenger1Weight">Passenger 1</label></td>
                        <td><input type="number" id="txtPassenger1Weight" name="passenger1_weight" /></td>
                        <td>lbs</td>
                        <td>39.0</td>
                        <td>39.0</td>
                    </tr>
                    <tr>
                        <td><label for="txtArea1Weight">Area 1 / Child Seat</label></td>
                        <td><input type="number" id="txtArea1Weight" name="area1_weight" /></td>
                        <td>lbs</td>
                        <td>64.0</td>
                        <td>64.0</td>
                    </tr>
                    <tr>
                        <td><label for="txtArea2Weight">Area 2</label></td>
                        <td><input type="number" id="txtArea2Weight" name="area2_weight" /></td>
                        <td>lbs</td>
                        <td>84.0</td>
                        <td>84.0</td>
                    </tr>
                    <tr>
                        <td><label for="txtFuelWeight">Fuel</label></td>
                        <td><input type="number" id="txtFuelWeight" name="fuel_weight" /></td>
                        <td>US Gallon</td>
                        <td>42.0</td>
                        <td>42.0</td>
                    </tr>
                    <tr>
                        <td><button id="btnCalculate" name="calculate">Calculate</button></td>
                        <td colspan="4"></td>
                    </tr>
                </table>
            </fieldset>
        </div>
        
        <div>
            <p>Center-of-Gravity Limits</p>
            <div id="pltAirplaneCGLocation" style="width:600px;height:400px;"></div>

            <script>
                airplaneCGEnvelope_C152 = {
                    type: 'scatter',
                    x: [31, 31, 32.65, 36.5, 36.5, 31],
                    y: [1000, 1350, 1670, 1670, 1000, 1000],
                };

                var layout = {
                    title: 'Cessna C152 - C.G. Limits',
                    xaxis: {
                        title: 'Cessna C152 - C.G. Location-Inches Aft of Datum',
                        range: [30, 37],
                        tickmode: 'linear',
                        tick0: 30,
                        dtick: 1
                    },
                    yaxis: {
                        title: 'Loaded Airplane Weight (Pounds)',
                        range: [1000, 1800],
                        tickmode: 'linear',
                        tick0: 1000,
                        dtick: 100
                    }
                };

                pltAirplaneCGLocation = Plotly.newPlot('pltAirplaneCGLocation', [airplaneCGEnvelope_C152], layout);
            </script>
        </div>

        <div>
            <p>Center-of-Gravity Moment Envelope</p>
            <div id="pltAirplaneCGMomentEnvelope" style="width:600px;height:400px;"></div>

            <script>
                airplaneCGMomentEnvelope_C152 = {
                    type: 'scatter',
                    x: [31, 54.5, 61, 36.5],
                    y: [1000, 1670, 1670, 1000],
                };

                var layout = {
                    title: 'Cessna C152 - C.G. Moment Envelope',
                    xaxis: {
                        title: 'Loaded Airplane Moment/1000 (Pound-Inches)',
                        range: [30, 65],
                        tickmode: 'linear',
                        tick0: 30,
                        dtick: 5
                    },
                    yaxis: {
                        title: 'Loaded Airplane Weight (Pounds)',
                        range: [1000, 1800],
                        tickmode: 'linear',
                        tick0: 1000,
                        dtick: 100
                    }
                };

                pltAirplaneCGMomentEnvelope = Plotly.newPlot('pltAirplaneCGMomentEnvelope', [airplaneCGMomentEnvelope_C152], layout);
            </script>
        </div>

        <div>
            <p>Loading Graph</p>
            <div id="pltAirplaneLoadingGraph" style="width:600px;height:400px;"></div>

            <script>
                pilotPassengerAndLongRangeFuelTanksLoadGraph_C152 = {
                    type: 'scatter',
                    x: [0, 15.5],
                    y: [0, 400],
                };
                fuelTanksLoadGraph_C152 = {
                    type: 'scatter',
                    x: [0, 6.2],
                    y: [0, 150],
                };
                area1LoadGraph_C152 = {
                    type: 'scatter',
                    x: [0, 7.7],
                    y: [0, 120],
                };
                area2LoadGraph_C152 = {
                    type: 'scatter',
                    x: [0, 3.3],
                    y: [0, 40],
                };

                var layout = {
                    title: 'Cessna C152 - Loading Graph',
                    xaxis: {
                        title: 'Load Moment/1000 (Pound-Inches)',
                        range: [0, 16],
                        tickmode: 'linear',
                        tick0: 0,
                        dtick: 1
                    },
                    yaxis: {
                        title: 'Load Weight (Pounds)',
                        range: [0, 500],
                        tickmode: 'linear',
                        tick0: 0,
                        dtick: 50
                    }
                };

                pltAirplaneLoadingGraph = Plotly.newPlot('pltAirplaneLoadingGraph', 
                    [pilotPassengerAndLongRangeFuelTanksLoadGraph_C152, fuelTanksLoadGraph_C152, area1LoadGraph_C152, area2LoadGraph_C152], layout);
            </script>
        </div>
    </body>
    <script>
        var btnCalculate = document.getElementById('btnCalculate');
        btnCalculate.addEventListener('click', function() {
            // Compute total moment and mass, check if inside envelope.
            // For C152.
            if (true) {
                var loadData = {
                    'pilot': Number(document.getElementById('txtPilotWeight').value),
                    'passenger1': Number(document.getElementById('txtPassenger1Weight').value),
                    'area1': Number(document.getElementById('txtArea1Weight').value),
                    'area2': Number(document.getElementById('txtArea2Weight').value),
                    'fuel': Number(document.getElementById('txtFuelWeight').value),
                };

                var sum = 0.0;
                for (const key in loadData) {
                    if (Number.isFinite(loadData[key])) {
                        sum += loadData[key] * aircraftArmData['C152'][key];
                    }
                }

                alert(sum);
            }
        });
    </script>
</html>